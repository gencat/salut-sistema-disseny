import{r as q,a as m}from"./lit-element-DhY7bShc.js";import{E as g}from"./lit-html-B2eaWknC.js";import{n as o}from"./property-DnLABHHV.js";import{b as f}from"./property-types-CkH-zh1n.js";import{e as b}from"./class-map-BDeD7Kfm.js";import{i as v,s as w,u as h}from"./static-B9bHPl91.js";import{g as y}from"./custom-element-scope-Dp4Dg8bo.js";import{c as T}from"./popper-CMBiYTiD.js";/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const O=i=>i??g,k=v`dss-calendar${w(y())}`,$=v`dss-icon${w(y())}`,C=v`dss-tooltip${w(y())}`,U=i=>{var a,l,u;const t={"dss-input-wrapper":!0,"dss-input-wrapper--required":i._required,"dss-input-wrapper--disabled":i._disabled,[`dss-input-wrapper--${i.inputSize}`]:!!i.inputSize},e={"dss-input-group":!0,[`dss-input-group--${i.inputSize}`]:!!i.inputSize,"dss-input-group--invalid":i._invalid||!i._inputValidity,"dss-input-group--required":i._required,"dss-input-group--disabled":i._disabled,"dss-input-group--focused":((a=i._input)==null?void 0:a.value)||i._placeholder||i._isFocused,"dss-input-group--read-only":i._readonly,"dss-input-group--no-label":!i._labelSlot},s={"dss-input-help":!0,"dss-input-help--invalid":i._invalid,"dss-input-help--disabled":i._disabled},r={"dss-calendar":!0,"dss-calendar--visible":i._showCalendar&&!i._readonly,"dss-calendar--disabled":i._disabled,"dss-calendar--md":i.inputSize!=="lg"};return h`
  
      <div class="${b(t)}">
  
        ${i.inputSize==="sm"?h`
          <div class="dss-wrapper-label">
            <slot name="label" @click=${i._focusInput}></slot>
          </div>
          `:g}
  
        <div 
          class="dss-input-dropdown-wrapper"
          role="combobox"
          aria-controls="datepicker-calendar"
          aria-expanded=${O(i._showCalendar)}>
          <div class="${b(e)}">
            ${i.icon&&i.icon!==""?h`
              <${$} icon="${i.icon}" class="dss-input-icon"></${$}>
              `:g}
            <div class="dss-input-field">
              ${i.inputSize!=="sm"?h`
                <slot name="label" @click=${i._focusInput}></slot>
                `:g}
              <slot name="input"
                @click=${i._handleClick}
                @input=${i._handleInput}
                @focusin=${i._handleFocus}
                @focusout=${i._handleBlur}
                @keydown=${i._handleKeyUp}
              ></slot>
              ${!i._showCalendar&&i._isTruncated?h`
                  <${C}>${(l=i._input)==null?void 0:l.value}</${C}>
                `:null}
            </div>
          </div>
  
          <${k}
            role="listbox"
            aria-label="Datepicker Calendar"
            id="datepicker-calendar"
            class="${b(r)}"
            .selectedDate=${(u=i._input)==null?void 0:u.value}
            .showTime=${i._showTime}
            .showButtons=${i._showButtons}
            .leftLabel=${i._leftLabel}
            .rightLabel=${i._rightLabel}
            .minDate=${i._minDate}
            .maxDate=${i._maxDate}
            timepickerLabel=${i._timepickerLabel}
            .timepicker=${i._timepicker}
            .customTimeListOptions=${i._customTimeListOptions}
            .minutesRange=${i._minutesRange}
            .minHour=${i._minHour}
            .maxHour=${i._maxHour}
            @onDateChange=${i._onDateChange}
            @onCancel=${i._onCancel}
          ></${k}>
        </div>
  
        ${i._helpText?h`
              <div class="${b(s)}">
                <span>${i._helpText}</span>
              </div>
            `:null}
      </div>
    `},V="*{scrollbar-width:thin;scrollbar-color:var(--color-neutral-100) var(--color-white)}*::-webkit-scrollbar{width:6px}*::-webkit-scrollbar-track{background:var(--color-white);border-radius:128px}*::-webkit-scrollbar-thumb{background-color:var(--color-neutral-100);border-radius:128px}",z='.dss-input-wrapper{display:flex;flex-direction:column;gap:var(--dss-spacing-xxs);width:100%;max-width:100%}.dss-input-wrapper--sm{gap:var(--dss-spacing-tiny)}.dss-input-icon{color:var(--color-neutral-900)}.dss-input-dropdown-wrapper{width:100%;max-width:100%}.dss-input-group{height:48px;width:100%;max-width:100%;min-width:200px;box-sizing:border-box;padding:0 var(--dss-spacing-sm);border:var(--dss-border-width-sm) solid var(--color-neutral-100);border-radius:var(--dss-radius-sm);display:flex;align-items:center;gap:var(--dss-spacing-xs);background-color:var(--color-white);font-family:var(--font-family)}.dss-input-group.dss-input-group--no-min-width{min-width:0}.dss-input-group--read-only{border-top-color:transparent;border-left-color:transparent;border-right-color:transparent;border-radius:0}.dss-input-group:focus-within{border-color:transparent;outline:var(--dss-border-width-lg) solid var(--color-blue-200)}.dss-input-group--read-only:focus-within{outline:none;position:relative}.dss-input-group--read-only:focus-within:before{pointer-events:none;content:"";position:absolute;top:100%;left:0;right:0;height:var(--dss-border-width-lg);background-color:var(--color-blue-200)}.dss-input-field{flex:1;min-width:0;display:flex;flex-direction:column;height:46px;position:relative}.dss-input-group--md{height:40px}.dss-input-group--md .dss-input-field{height:38px}.dss-input-group--sm{height:32px;padding:0 var(--dss-spacing-xs)}.dss-input-group--sm .dss-input-field{height:30px}.dss-wrapper-label ::slotted(label){font-size:14px;font-weight:var(--font-semibold);line-height:24px;color:var(--color-neutral-700)}.dss-input-wrapper--disabled .dss-wrapper-label ::slotted(label){color:var(--color-neutral-500)}.dss-input-field ::slotted(label){position:absolute;top:50%;transform:translateY(-50%);left:0;font-size:14px;color:var(--color-neutral-600);transition:all .3s ease-in-out;max-height:24px;width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.dss-input-field:focus-within ::slotted(label),.dss-input-group--focused ::slotted(label){font-size:12px;top:var(--dss-spacing-tiny);transform:translateY(0)}.dss-input-group--md .dss-input-field:focus-within ::slotted(label),.dss-input-group--md.dss-input-group--focused ::slotted(label){top:0}.dss-input-field ::slotted(input){border:none;height:100%;padding:0;box-sizing:border-box;color:var(--color-neutral-900);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;font-size:14px}.dss-input-group:not(.dss-input-group--sm) .dss-input-field ::slotted(input){padding-top:var(--dss-spacing-md)!important;padding-bottom:var(--dss-spacing-xxs)!important}.dss-input-field ::slotted(input:-moz-placeholder-shown){border:none;outline:none;height:100%}.dss-input-field ::slotted(input:focus-visible),.dss-input-field ::slotted(input:placeholder-shown){border:none;outline:none;height:100%}.dss-input-field ::slotted(input::-moz-placeholder){color:var(--color-neutral-600)}.dss-input-field ::slotted(input::placeholder){color:var(--color-neutral-600)}.dss-input-group--disabled{cursor:not-allowed;background-color:var(--color-neutral-50);color:var(--color-neutral-500)}.dss-input-group--disabled .dss-input-field ::slotted(label){cursor:not-allowed!important;color:var(--color-neutral-500)}.dss-input-group--disabled .dss-input-field ::slotted(input){cursor:not-allowed!important;background-color:var(--color-neutral-50);color:var(--color-neutral-500)}.dss-input-help{display:flex;justify-content:space-between;font-family:var(--font-family);font-size:12px;color:var(--color-neutral-700);padding:0 var(--dss-spacing-sm)}.dss-input-help--disabled{color:var(--color-neutral-500)}.dss-input-group--invalid:not(.dss-input-group--disabled):not(:focus-within){background-color:var(--color-red-50);border-color:var(--color-red-500)}.dss-input-group--invalid:not(.dss-input-group--disabled) .dss-input-field ::slotted(label){color:var(--color-red-500)}.dss-input-group--invalid:not(.dss-input-group--disabled):not(:focus-within) .dss-input-field ::slotted(input){background-color:var(--color-red-50)}.dss-input-group--invalid:not(.dss-input-group--disabled) .dss-input-help--invalid{color:var(--color-red-500)}.dss-input-wrapper--required ::slotted(label):before,.dss-input-group--required ::slotted(label):before{content:"*"}.dss-input-numeric-buttons{padding:0;display:flex;flex-direction:column;justify-content:center;transition:all .3s ease-in;height:100%}.dss-input-numeric-buttons .dss-icon-button{display:flex;justify-content:center;text-align:center;width:18px;height:18px;align-items:center;font-size:16px}.dss-input-group.dss-input-group--no-label .dss-input-field ::slotted(input){padding-top:0!important;padding-bottom:0!important}',H=".dss-datepicker-help{font-family:var(--font-family)}.dss-datepicker-help{font-family:inherit;font-size:12px;color:var(--color-neutral-700);padding:var(--dss-spacing-xxs) var(--dss-spacing-sm)}.dss-datepicker-help--disabled{color:var(--color-neutral-500)}.dss-datepicker-help--invalid{color:var(--color-red-500)}.dss-calendar{z-index:999;width:-moz-fit-content;width:fit-content;opacity:0;visibility:hidden}.dss-calendar--visible{opacity:1;visibility:visible}";var R=Object.defineProperty,F=Object.getOwnPropertyDescriptor,n=(i,t,e,s)=>{for(var r=s>1?void 0:s?F(t,e):t,a=i.length-1,l;a>=0;a--)(l=i[a])&&(r=(s?l(t,e,r):l(r))||r);return s&&r&&R(t,e,r),r};class d extends q{constructor(){super(),this.icon="calendar_today",this.inputSize="lg",this.dropdownPlacement="bottom-start",this.dropdownFixed=!1,this._timepickerLabel="Seleccionar l'hora",this._timepicker="",this._minutesRange=1,this._minHour=0,this._maxHour=24,this._customTimeListOptions=[],this._placeholder="",this._externalPlaceholder="",this._previousDate="",this._minDate="",this._maxDate="",this._showCalendar=!1,this._showTime=!1,this._invalid=!1,this._showButtons=!1,this._required=!1,this._disabled=!1,this._readonly=!1,this._leftLabel="CancelÂ·lar",this._rightLabel="Seleccionar",this._isFocused=!1,this._helpText="",this._inputValidity=!0,this._popperInstance=null,this.observerConfig={attributes:!0,childList:!0,subtree:!0},this.callback=t=>{for(const e of t)e.type==="attributes"&&(this._checkInputAttributes(),this.requestUpdate())},this.observer=new MutationObserver(this.callback),this.visibleObserver=new IntersectionObserver(([t])=>{t.isIntersecting||this._showCalendar&&this._closeCalendar()},{root:null,threshold:0}),this._isTruncated=!1,this._handleOutsideClick=this._handleOutsideClick.bind(this),this._handleFocusOut=this._handleFocusOut.bind(this)}static get styles(){return[m(z),m(V),m(H)]}get _input(){var e;const t=((e=this.shadowRoot)==null?void 0:e.querySelector('slot[name="input"]'))||void 0;return this.requestUpdate(),t==null?void 0:t.assignedElements()[0]}get _labelSlot(){var e;const t=((e=this.shadowRoot)==null?void 0:e.querySelector('slot[name="label"]'))||void 0;return t==null?void 0:t.assignedElements()[0]}get _label(){var e;const t=((e=this.shadowRoot)==null?void 0:e.querySelector('slot[name="label"]'))||void 0;return this.requestUpdate(),t==null?void 0:t.assignedElements()[0]}set showTime(t){const e=this._showTime;this._showTime=t,this._showButtons=!0,this.requestUpdate("showTime",e)}get showTime(){return this._showTime}set showButtons(t){const e=this._showButtons;this._showButtons=t,this.requestUpdate("showButtons",e)}get showButtons(){return this._showButtons}set leftLabel(t){const e=this._leftLabel;this._leftLabel=t,this.requestUpdate("leftLabel",e)}get leftLabel(){return this._leftLabel}set rightLabel(t){const e=this._rightLabel;this._rightLabel=t,this.requestUpdate("rightLabel",e)}get rightLabel(){return this._rightLabel}set minDate(t){const e=this._minDate;this._minDate=t,this.requestUpdate("minDate",e)}get minDate(){return this._minDate}set maxDate(t){const e=this._maxDate;this._maxDate=t,this.requestUpdate("maxDate",e)}get maxDate(){return this._maxDate}set invalid(t){const e=this._invalid;this._invalid=t,this.requestUpdate("invalid",e)}get invalid(){return this._invalid}set helpText(t){const e=this._helpText;this._helpText=t,this.requestUpdate("helpText",e)}get helpText(){return this._helpText}set timepicker(t){const e=this._timepicker;this._timepicker=t,this.requestUpdate("timepicker",e)}get timepicker(){return this._timepicker}set minutesRange(t){const e=this._minutesRange;this._minutesRange=t,this.requestUpdate("minutesRange",e)}get minutesRange(){return this._minutesRange}set minHour(t){const e=this._minHour;this._minHour=t,this.requestUpdate("minHour",e)}get minHour(){return this._minHour}set maxHour(t){const e=this._maxHour;this._maxHour=t,this.requestUpdate("maxHour",e)}get maxHour(){return this._maxHour}set customTimeListOptions(t){const e=this._customTimeListOptions;this._customTimeListOptions=t,this.requestUpdate("customTimeListOptions",e)}get customTimeListOptions(){return this._customTimeListOptions}set timepickerLabel(t){const e=this._timepickerLabel;this._timepickerLabel=t,this.requestUpdate("timepickerLabel",e)}get timepickerLabel(){return this._timepickerLabel}set value(t){t!==void 0&&this.requestUpdate()}get value(){var t;return(t=this._input)==null?void 0:t.value}disconnectedCallback(){this._removeCalendarListener(),this.observer.disconnect(),this.visibleObserver.disconnect()}_addCalendarListener(){document.addEventListener("click",this._handleOutsideClick),this.addEventListener("focusout",this._handleFocusOut)}_removeCalendarListener(){document.removeEventListener("click",this._handleOutsideClick),this.removeEventListener("focusout",this._handleFocusOut)}_handleOutsideClick(t){this._checkClickOutside(t)}_handleFocusOut(t){this._checkFocusOut(t)}async firstUpdated(){try{await this.updateComplete,this._createPopperCalendar(),this._input&&(this._checkInputAttributes(),this.observer.observe(this._input,this.observerConfig),this.visibleObserver.observe(this._input)),this.requestUpdate()}catch{console.error("ERROR OCURRED")}}_createPopperCalendar(){var s,r;const t=(s=this.shadowRoot)==null?void 0:s.querySelector(".dss-input-group"),e=(r=this.shadowRoot)==null?void 0:r.querySelector(".dss-calendar");t&&e&&(this._popperInstance=T(t,e,{placement:this.dropdownPlacement,strategy:this.dropdownFixed?"fixed":"absolute",modifiers:[{name:"offset",options:{offset:[0,4]}}]}))}_checkInputAttributes(){var a,l,u,p,c,_;const t=(a=this._input)==null?void 0:a.getAttribute("placeholder");t&&(this._placeholder=t,this._externalPlaceholder=t);const e=(l=this._input)==null?void 0:l.getAttribute("readonly");this._readonly=e!==null;const s=(u=this._input)==null?void 0:u.getAttribute("disabled");this._disabled=s!==null;const r=(p=this._input)==null?void 0:p.getAttribute("required");this._required=r!==null,(c=this._input)!=null&&c.value&&((_=this._input)==null?void 0:_.value)!==""&&this._handleValidity(),this.requestUpdate()}_handleValidity(){var e;const t=(e=this._input)==null?void 0:e.checkValidity();t!==void 0&&(this._inputValidity=t)}_checkClickOutside(t){t.composedPath().includes(this)||this._showCalendar&&this._closeCalendar()}_checkFocusOut(t){const e=t.relatedTarget;e!==null&&e!==this&&e!==this._input&&e!==this._label&&this._showCalendar&&this._closeCalendar()}_closeCalendar(){var t,e;this._removeCalendarListener(),(t=this._input)==null||t.removeAttribute("placeholder"),this._placeholder="",this._isFocused=!1,this._showCalendar=!1,(e=this._input)==null||e.blur(),this.requestUpdate()}_handleKeyUp(t){var e,s,r,a,l;if((t==null?void 0:t.key)==="Tab"?(this._isFocused=!0,this._handleBlur()):(t==null?void 0:t.key)==="Enter"||(t==null?void 0:t.key)===" "?(this._showCalendar=!0,this._popperInstance.update(),this._handleBlur(),this._addCalendarListener()):(t==null?void 0:t.key)==="Escape"&&(this._closeCalendar(),this._isFocused=!0,this._handleBlur()),t.key==="Enter"&&this._input&&((e=this._input.value)==null?void 0:e.length)>7&&this._input){const u=(s=this._input.value)==null?void 0:s.replace(/(\d+[/])(\d+[/])/,"$2$1"),p=new Date(u),c=(r=p.getDate())==null?void 0:r.toString().padStart(2,"0"),_=(p.getMonth()+1).toString().padStart(2,"0"),L=p.getFullYear(),S=(a=p.getHours())==null?void 0:a.toString().padStart(2,"0"),D=(l=p.getMinutes())==null?void 0:l.toString().padStart(2,"0");let x=`${c}/${_}/${L}`;this._showTime&&(x+=` ${S}:${D}`,this._handleValidity()),this._input&&(this._input.value=x),this._dispatchValueChange(),this.requestUpdate()}}_handleInput(t){var s;const e=(s=t.target.value)==null?void 0:s.replace(/\D/g,"");this._input&&(this._input.value=this._formatDate(e),this._handleValidity()),this._dispatchValueChange(),this.requestUpdate()}_formatDate(t){let e=t.substring(0,2),s=t.substring(2,4);const r=t.substring(4,8);let a=t.substring(8,10),l=t.substring(10,12);Number(e)>3&&(e=e==null?void 0:e.padStart(2,"0")),Number(s)>1&&(s=s==null?void 0:s.padStart(2,"0")),Number(e)>31&&(e="31"),Number(s)>12&&(s="12"),s==="02"&&Number(e)>28&&(r==null?void 0:r.length)===4&&(e=new Date(Number(r),1,29).getMonth()===1?"29":"28");let u=`${e}${s?`/${s}`:""}${r?`/${r}`:""}`;return this._showTime&&(Number(a)>2&&(a=a==null?void 0:a.padStart(2,"0")),Number(a)>23&&(a="23"),Number(l)>5&&(l=l==null?void 0:l.padStart(2,"0")),u=`${u}${a?` ${a}`:""}${l?`:${l}`:""}`),u}_handleFocus(){var t;this._readonly||(this._externalPlaceholder!==""?this._placeholder=this._externalPlaceholder:this._placeholder=this._showTime?"DD/MM/AAAA HH:MM":"DD/MM/AAAA",(t=this._input)==null||t.setAttribute("placeholder",this._placeholder),this.requestUpdate())}_handleBlur(){this._checkInputOverflow(),this.requestUpdate()}_focusInput(){var t;!this._disabled&&!this._readonly&&((t=this._input)==null||t.focus(),this._handleClick())}_handleClick(){this._showCalendar=!0,this._popperInstance.update(),this._addCalendarListener(),this.requestUpdate()}_onDateChange(t){const e=t.detail;this._input&&(this._input.value=e,this._handleValidity()),this._closeCalendar(),this._dispatchValueChange()}_onCancel(){this._closeCalendar(),this._input&&(this._input.value=this._previousDate||"",this._handleValidity()),this.requestUpdate()}_dispatchValueChange(){var e;const t={detail:(e=this._input)==null?void 0:e.value,bubbles:!0,composed:!0};this.dispatchEvent(new CustomEvent("onValueChange",t))}_checkInputOverflow(){if(!this._input)return;const t=window.getComputedStyle(this._input),e=`${t.fontWeight} ${t.fontSize} ${t.fontFamily}`,r=document.createElement("canvas").getContext("2d");if(!r)return;r.font=e;const a=r.measureText(this._input.value).width;this._isTruncated=a>this._input.offsetWidth}render(){return U(this)}}n([o(f)],d.prototype,"showTime",1);n([o(f)],d.prototype,"showButtons",1);n([o({type:String})],d.prototype,"leftLabel",1);n([o({type:String})],d.prototype,"rightLabel",1);n([o({type:String})],d.prototype,"minDate",1);n([o({type:String})],d.prototype,"maxDate",1);n([o(f)],d.prototype,"invalid",1);n([o({type:String})],d.prototype,"icon",2);n([o({type:String})],d.prototype,"inputSize",2);n([o({type:String})],d.prototype,"helpText",1);n([o({type:String})],d.prototype,"timepicker",1);n([o({type:Number})],d.prototype,"minutesRange",1);n([o({type:Number})],d.prototype,"minHour",1);n([o({type:Number})],d.prototype,"maxHour",1);n([o({type:Array})],d.prototype,"customTimeListOptions",1);n([o({type:String})],d.prototype,"timepickerLabel",1);n([o({type:String})],d.prototype,"value",1);n([o({type:String})],d.prototype,"dropdownPlacement",2);n([o(f)],d.prototype,"dropdownFixed",2);export{d as D,z as i,O as o,V as s};
